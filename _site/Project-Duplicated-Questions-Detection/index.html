<!DOCTYPE html> <!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--> <!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8"><![endif]--> <!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9"><![endif]--> <!--[if gt IE 8]><!--> <html class="no-js"><!--<![endif]--> <head> <meta charset="UTF-8"> <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"> <meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"> <title>Duplicated Questions Detection &#8211; Zibo Yi</title> <meta name="description" content=""> <meta name="keywords" content="Tensorflow, CNN, RNN"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="/assets/img/logo.png"> <meta name="twitter:title" content="Duplicated Questions Detection"> <meta name="twitter:description" content="Detecting duplicated questions in Quora"> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="Duplicated Questions Detection"> <meta property="og:description" content="Detecting duplicated questions in Quora"> <meta property="og:url" content="/Project-Duplicated-Questions-Detection/"> <meta property="og:site_name" content="Zibo Yi"> <meta property="og:image" content="/assets/img/logo.png"> <link rel="canonical" href="/Project-Duplicated-Questions-Detection/"> <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Zibo Yi Feed"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- CSS --> <link rel="stylesheet" href="/assets/css/main.css"> <!-- JS --> <script src="/assets/js/modernizr-3.3.1.custom.min.js"></script> <!-- Favicons --> <link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"> <link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"> <link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"> <link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"> <link rel="shortcut icon" type="image/png" href="/favicon.png" /> <link rel="shortcut icon" href="/favicon.ico" /> <!-- Background Image --> <style type="text/css">body {background-image:url(/assets/img/homepagebackground.png); background-repeat: no-repeat; background-size: cover; }</style> <!-- Post Feature Image --> </head> <body> <nav id="dl-menu" class="dl-menuwrapper" role="navigation"> <button class="dl-trigger">Open Menu</button> <ul class="dl-menu"> <li><a href="/">Home</a></li> <li> <a href="#">About</a> <ul class="dl-submenu"> <li> <img src="/assets/img/logo.png" alt="Zibo Yi photo" class="author-photo"> <h4>Zibo Yi</h4> <p></p> </li> <li><a href="/about/"><span class="btn btn-inverse">Learn More</span></a></li> </ul><!-- /.dl-submenu --> </li> <li> <a href="#">Posts</a> <ul class="dl-submenu"> <li><a href="/posts/">All Posts</a></li> <li><a href="/tags/">All Tags</a></li> </ul> </li> <li><a href="/projects/" >Projects</a></li> </ul><!-- /.dl-menu --> </nav><!-- /.dl-menuwrapper --> <!-- Header --> <header class="header" role="banner"> <div class="wrapper animated fadeIn"> <div class="content"> <div class="post-title "> <h1>Duplicated Questions Detection</h1> <h4>29 Sep 2017</h4> <p class="reading-time"> <i class="fa fa-clock-o"></i> Reading time ~3 minutes </p><!-- /.entry-reading-time --> <a class="btn zoombtn" href="/projects/"> <i class="fa fa-chevron-left"></i> </a> </div> <h2 id="background">Background</h2> <p>In Quora, there are too many questions meaning the same. For example, the two sentence “What is the most populous state in the USA?” and “Which state in the United States has the most people?” are asking the same thing. If duplicated questions are detected, it would be more efficient for user searching answers.</p> <p>Traditional NLP method can be used for solving this problem, such as cosine similarity and Jaccard similarity [1]. In this post a recurrent neural network is described for detecting duplicated questions.</p> <h2 id="the-task">The Task</h2> <p>Quora issues the dataset [2] for duplicated questions detection. Part of the dataset is:</p> <p><img src="https://github.com/ziboyi/Duplicated-Questions-Detection/blob/master/figure/Duplicated-Questions.png?raw=true" alt="" /></p> <p>We need a model that can tell whether two questions are duplicated.</p> <h2 id="the-model">The Model</h2> <p>The architecture of the model is:</p> <p><img src="https://github.com/ziboyi/Duplicated-Questions-Detection/blob/master/figure/arch.png?raw=true" alt="" /></p> <p>The remaining part of this section will describle the model layer by layer.</p> <h3 id="embedding-layer">Embedding Layer</h3> <p>Giving a sentence \( S=(w_1, w_2,…, w_t) \), each word will represented as a row vector \( x_i \).</p> <h3 id="encoding-layer">Encoding Layer</h3> <p><img src="https://github.com/ziboyi/Duplicated-Questions-Detection/blob/master/figure/Bi-LSTM.png?raw=true" alt="" /></p> <p>The bi-LSTM takes the sentence in forward and backward direction, and output the features of each time step. This layer encodes the sentence to a vector \( r \).</p> <p>\[ r=[F_{h_1}, B_{h_1}, F_{h_2}, B_{h_2},…, F_{h_t}, B_{h_t}] \]</p> <p>The following picture shows the LSTM cell.</p> <p><img src="https://github.com/ziboyi/Duplicated-Questions-Detection/blob/master/figure/LSTM-Cell.png?raw=true" alt="" /></p> <p>The output of each cell \( h_i \) are computed by the following equation,</p> <p>\[ f_i=\sigma([h_{i-1},x_i]W_f+b_f) \] \[ i_i=\sigma([h_{i-1},x_i]W_i+b_i) \] \[ g_i={\textrm{tanh}}([h_{i-1},x_i]W_g+b_g) \] \[ c_i=c_{i-1}\otimes{f_i}+i_i\otimes{g_i} \] \[ o_i=\sigma([h_{i-1},x_i]W_o+b_o)\] \[ h_i={\textrm{tanh}}(c_i)\otimes{o_i} \]</p> <h3 id="multiple-layer-perceptron">Multiple Layer Perceptron</h3> <p>The input of MLP is</p> <p>\[ p=[r_1,r_2,r_1-r_2,r_1\cdot{r_2}] \]</p> <p>and MLP classifies feature vector \( p \) as a class that indicate whether the two questions are the same. Class 0 means the two questions are not duplicate, while class 1 means they are duplicate. Let \( y \) denotes the class. MLP and \( y \) are calculated as follows,</p> <p>\[ H_3={\textrm{relu}}(pW_3+b_3) \] \[ H_4={\textrm{relu}}(H_3W_4+b_4) \] \[ s={\textrm{softmax}}(H_4W_5+b_5) \]</p> <p>\[ y={\textrm{argmax}}_i{s_i} \]</p> <h3 id="training-the-model">Training the Model</h3> <p>For the given two sentence, the loss function is:</p> <p>\[ l_i=-\sum_{c\in C}{y_{ic}{\textrm{ln}}(s_{ic})} \] \[ l=\frac{1}{N}\sum_{i=1}^N{l_i}=-\frac{1}{N}\sum_{i=1}^N{\sum_{c\in C}{y_{ic}{\textrm{ln}}(s_{ic})}} \]</p> <p>\( y_{ic} \) means that whether instance \( i \) belongs in class \( c \). The parameters of this model are as follows.</p> <p>\[ \theta={W_f,b_f,W_i,b_i,W_g,b_g,W_o,b_o,W_3,b_3,W_4,b_4,W_5,b_5} \]</p> <p>Use optimization method “Adam”[3] to optimaze the loss function. After training, the model can tell whether two given sentences are asking the same thing.</p> <h2 id="experiment">Experiment</h2> <p>Dataset is split to training and testing set during preprocessing.</p> <p><img src="https://github.com/ziboyi/Duplicated-Questions-Detection/blob/master/figure/preprocessing.png?raw=true" alt="" /></p> <p>Next step train this model, please check the hyperparameters.</p> <p><img src="https://github.com/ziboyi/Duplicated-Questions-Detection/blob/master/figure/training.png?raw=true" alt="" /></p> <p>Then evaluate this model after training.</p> <p><img src="https://github.com/ziboyi/Duplicated-Questions-Detection/blob/master/figure/eval-RNN.png?raw=true" alt="" /></p> <p>I modify the model to CNN version and evaluate it again. I also use Jaccard similarity as the baseline, the evaluation are shown in the following table.</p> <table rules="groups"> <thead> <tr> <th style="text-align: left">Model</th> <th style="text-align: center">Accuracy</th> <th style="text-align: right">Precision</th> <th style="text-align: center">Recall</th> <th style="text-align: right">F1</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">baseline</td> <td style="text-align: center">0.6657</td> <td style="text-align: right">0.5151</td> <td style="text-align: center">0.7297</td> <td style="text-align: right">0.6039</td> </tr> <tr> <td style="text-align: left">CNN based model</td> <td style="text-align: center">0.7911</td> <td style="text-align: right">0.6894</td> <td style="text-align: center">0.7316</td> <td style="text-align: right">0.7098</td> </tr> <tr> <td style="text-align: left">LSTM based model</td> <td style="text-align: center">0.8126</td> <td style="text-align: right">0.7085</td> <td style="text-align: center">0.7874</td> <td style="text-align: right">0.7459</td> </tr> </tbody> </table> <h2 id="conclusions">Conclusions</h2> <p>LSTM based model has a better performance in this task.</p> <h2 id="references">References</h2> <p>[1] Jaccard, P. (1901). Étude comparative de la distribution florale dans une portion des Alpes et des Jura. Bulletin de la SociétéVaudoise des Sciences Naturelles 37, 547-579.</p> <p>[2] https://data.quora.com/First-Quora-Dataset-Release-Question-Pairs, Quora Duplicate Questions Dataset.</p> <p>[3] Kingma D, Ba J. Adam: A method for stochastic optimization[J]. arXiv preprint arXiv:1412.6980, 2014.</p> <div class="entry-meta"> <br> <hr> <span class="entry-tags"><a href="/tags/#Tensorflow" title="Pages tagged Tensorflow" class="tag"><span class="term">Tensorflow</span></a><a href="/tags/#CNN" title="Pages tagged CNN" class="tag"><span class="term">CNN</span></a><a href="/tags/#RNN" title="Pages tagged RNN" class="tag"><span class="term">RNN</span></a></span> <span class="social-share"> <a href="https://www.facebook.com/sharer/sharer.php?u=/Project-Duplicated-Questions-Detection/" title="Share on Facebook" class="tag"> <span class="term"><i class="fa fa-facebook-square"></i> Share</span> </a> <a href="https://twitter.com/intent/tweet?text=/Project-Duplicated-Questions-Detection/" title="Share on Twitter" class="tag"> <span class="term"><i class="fa fa-twitter-square"></i> Tweet</span> </a> <a href="https://plus.google.com/share?url=/Project-Duplicated-Questions-Detection/" title="Share on Google+" class="tag"> <span class="term"><i class="fa fa-google-plus-square"></i> +1</span> </a> </span> <div style="clear:both"></div> </div> </div> </div> </header> <!-- JS --> <script src="/assets/js/jquery-1.12.0.min.js"></script> <script src="/assets/js/jquery.dlmenu.min.js"></script> <script src="/assets/js/jquery.goup.min.js"></script> <script src="/assets/js/jquery.magnific-popup.min.js"></script> <script src="/assets/js/jquery.fitvid.min.js"></script> <script src="/assets/js/scripts.js"></script> <!-- MathJax --> <script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> </body> </html>
