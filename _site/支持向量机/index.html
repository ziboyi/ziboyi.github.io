<!DOCTYPE html> <!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--> <!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8"><![endif]--> <!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9"><![endif]--> <!--[if gt IE 8]><!--> <html class="no-js"><!--<![endif]--> <head> <meta charset="UTF-8"> <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"> <meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"> <title>支持向量机 &#8211; Zibo Yi</title> <meta name="description" content=""> <meta name="keywords" content="Machine Learning, SVM"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="/assets/img/logo.png"> <meta name="twitter:title" content="支持向量机"> <meta name="twitter:description" content="线性可分集与线性不可分集上的支持向量机"> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="支持向量机"> <meta property="og:description" content="线性可分集与线性不可分集上的支持向量机"> <meta property="og:url" content="/%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/"> <meta property="og:site_name" content="Zibo Yi"> <meta property="og:image" content="/assets/img/logo.png"> <link rel="canonical" href="/%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/"> <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Zibo Yi Feed"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- CSS --> <link rel="stylesheet" href="/assets/css/main.css"> <!-- JS --> <script src="/assets/js/modernizr-3.3.1.custom.min.js"></script> <!-- Favicons --> <link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"> <link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"> <link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"> <link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"> <link rel="shortcut icon" type="image/png" href="/favicon.png" /> <link rel="shortcut icon" href="/favicon.ico" /> <!-- Background Image --> <style type="text/css">body {background-image:url(/assets/img/homepagebackground.png); background-repeat: no-repeat; background-size: cover; }</style> <!-- Post Feature Image --> </head> <body> <nav id="dl-menu" class="dl-menuwrapper" role="navigation"> <button class="dl-trigger">Open Menu</button> <ul class="dl-menu"> <li><a href="/">Home</a></li> <li> <a href="#">About</a> <ul class="dl-submenu"> <li> <img src="/assets/img/logo.png" alt="Zibo Yi photo" class="author-photo"> <h4>Zibo Yi</h4> <p></p> </li> <li><a href="/about/"><span class="btn btn-inverse">Learn More</span></a></li> </ul><!-- /.dl-submenu --> </li> <li> <a href="#">Posts</a> <ul class="dl-submenu"> <li><a href="/posts/">All Posts</a></li> <li><a href="/tags/">All Tags</a></li> </ul> </li> <li><a href="/projects/" >Projects</a></li> </ul><!-- /.dl-menu --> </nav><!-- /.dl-menuwrapper --> <!-- Header --> <header class="header" role="banner"> <div class="wrapper animated fadeIn"> <div class="content"> <div class="post-title "> <h1>支持向量机</h1> <h4>16 Nov 2017</h4> <p class="reading-time"> <i class="fa fa-clock-o"></i> Reading time ~2 minutes </p><!-- /.entry-reading-time --> <a class="btn zoombtn" href="/posts/"> <i class="fa fa-chevron-left"></i> </a> </div> <h2 id="1考虑在线性可分集上的超平面将两类点分开">1.考虑在线性可分集上的超平面将两类点分开</h2> <figure> <img src="/posts/SVM/margin.png" /> </figure> <p>设图中的超平面为\( w^T x + b = 0 \), 样本集到超平面的距离为：\( \rho = \textrm{min} \frac{y_i(w^T x_i + b)}{|w|} = \frac{a}{|w|}\) (即图中的margin为\(\frac{a}{|w|}\))</p> <p>SVM的优化目标：最大化\(\frac{a}{|w|}\)，约束为\( y_i(w^T x_i + b) \geq a\)</p> <p>令\( \hat{w} = \frac{w}{a}, \hat{b}=\frac{b}{a}\), 则优化目标变为：最大化\(\frac{1}{|\hat{w}|}\)，约束为\( y_i(\hat{w}^T x_i + \hat{b}) \geq 1\)</p> <p>注意：将超平面由\( w^T x + b = 0 \)变换到\( \hat{w}^T x + \hat{b} = 0 \)并不改变分类结果，因为\( \textrm{sign}(w^T x + b) = \textrm{sign}(\hat{w}^T x + \hat{b})\)</p> <p>不妨将优化目标记为：\(\textrm{min } \frac{1}{2}{|w|}^2, s.t. y_i(w^T x_i + b) \geq 1, \forall i\)</p> <h3 id="lagrange乘数法与kkt条件">Lagrange乘数法与KKT条件</h3> <p>构造拉格朗日函数（\(\alpha_i\)非负)：\(L(w,b,\alpha)=\frac{1}{2}|w|^2-\sum{\alpha_i[y_i(w^T x_i + b)-1]}\)</p> <p>使得\(L\)取得极值的\(w,b,\alpha\)需满足：\(\frac{\partial L}{\partial w}=0;\frac{\partial L}{\partial b}=0;\forall i,\alpha_i[y_i(w^T x_i + b)-1]=0\). 即：</p> <p>\[w=\sum{\alpha_i y_i x_i}\] \[\sum{\alpha_i y_i}=0\] \[\alpha_i=0 \textrm{ OR } y_i(w^T x_i + b)=1, \forall i\]</p> <p>则</p> <div> \begin{align} L &amp;= \frac{1}{2}w^T w - \sum{\alpha_i y_i w^T x_i} - b\sum{\alpha_i y_i} + \sum{\alpha_i} \\ &amp;= \frac{1}{2}w^T\sum{\alpha_i y_i x_i} - \sum{\alpha_i y_i w^T x_i} - 0 + \sum{\alpha_i} \\ &amp;= \sum{\alpha_i} - \frac{1}{2}\sum{\alpha_i y_i w^T x_i} \\ &amp;= \sum{\alpha_i} - \frac{1}{2}\sum\sum{\alpha_i y_i \alpha_j y_j x_i^T x_j} \end{align} </div> <h3 id="对偶问题">对偶问题</h3> <p>转化成求如下对偶问题： \[\textrm{max} Q(\alpha)=\sum{\alpha_i}-\frac{1}{2}\sum\sum{\alpha_i y_i \alpha_j y_j x_i^T x_j} \textrm{ s.t. } \sum{\alpha_i y_i}=0, \alpha_i \geq 0\]</p> <p>注意，支持向量的\(\alpha_i \neq 0\)，即满足\(y_i(w^T x_i + b)=1\)的点，求解该对偶问题可以得到\(\alpha_i\)，则</p> <p>\[w = \sum{\alpha_i y_i x_i}\] \[b = y_i - w^T x_i \textrm{ (Any } (x_i, y_i) \textrm{ which satisfies } \alpha_i \neq 0 \textrm{ will be alright.)}\]</p> <h2 id="2考虑在线性不可分集上的情况">2.考虑在线性不可分集上的情况</h2> <figure> <img src="/posts/SVM/margin-non-separable.png" /> </figure> <p>\(\exists x_i\), 使得\(y_i(w^T x_i + b) &lt; 1\), 此时的优化目标引入松弛变量\(\xi_i\).</p> <p>\[\textrm{min }\frac{1}{2}|w|^2 + C\sum{\xi_i}\] \[ \textrm{ s.t. } y_i(w^T x_i + b) \geq 1 - \xi_i, \xi_i \geq 0, \forall i\]</p> <h3 id="lagrange乘数法与kkt条件-1">Lagrange乘数法与KKT条件</h3> <p>构造拉格朗日函数（\(\alpha_i, \beta_i\)非负)： \[L(w,b,\xi,\alpha,\beta)=\frac{1}{2}|w|^2 + C\sum{\xi_i} - \sum{\alpha_i[y_i(w^T x_i + b)-1+\xi_i]} - \sum{\beta_i \xi_i}\]</p> <p>使得\(L\)取得极值的\(w,b,\xi,\alpha,\beta\)需满足：\(\frac{\partial L}{\partial w}=0;\frac{\partial L}{\partial b}=0;\forall i,\frac{\partial L}{\partial \xi_i}=0;\forall i,\alpha_i[y_i(w^T x_i + b)-1+\xi_i]=0;\)</p> <p>\(\forall i, \beta_i \xi_i = 0\). 即：</p> <p>\[w=\sum{\alpha_i y_i x_i}\] \[\sum{\alpha_i y_i}=0\] \[\alpha_i + \beta_i = C\] \[\alpha_i=0 \textrm{ OR } y_i(w^T x_i + b) = 1 - \xi_i, \forall i\] \[\beta_i=0 \textrm{ OR } \xi_i = 0, \forall i\]</p> <p>则</p> <div> \begin{align} L &amp;= \frac{1}{2}w^T w + C\sum{\xi_i} - \sum{\alpha_i y_i w^T x_i} - b\sum{\alpha_i y_i} + \sum{\alpha_i} - \sum{\alpha_i \xi_i} - \sum{\beta_i \xi_i}\\ &amp;= \frac{1}{2}w^T\sum{\alpha_i y_i x_i} + C\sum{\xi_i} - \sum{\alpha_i y_i w^T x_i} - 0 + \sum{\alpha_i} - \sum{\alpha_i \xi_i} - \sum{\beta_i \xi_i} \\ &amp;= \sum{\alpha_i} - \frac{1}{2}\sum{\alpha_i y_i w^T x_i} + \sum{(C - \alpha_i - \beta_i) \xi_i} \\ &amp;= \sum{\alpha_i} - \frac{1}{2}\sum\sum{\alpha_i y_i \alpha_j y_j x_i^T x_j} \end{align} </div> <h3 id="对偶问题-1">对偶问题</h3> <p>转化成求如下对偶问题： \[\textrm{min } Q(\alpha)=\frac{1}{2}\sum\sum{\alpha_i y_i \alpha_j y_j x_i^T x_j} - \sum{\alpha_i} \] \[\textrm{ s.t. } \sum{\alpha_i y_i}=0, C \geq \alpha_i \geq 0, \forall i\]</p> <p>求解该对偶问题可以得到\(\alpha_i\)，则 \[w = \sum{\alpha_i y_i x_i}\] \[b = y_i - w^T x_i \textrm{ (Any } (x_i, y_i) \textrm{ which satisfies } 0 &lt; \alpha_i &lt; C \textrm{ will be alright.)}\]</p> <div class="entry-meta"> <br> <hr> <span class="entry-tags"><a href="/tags/#Machine Learning" title="Pages tagged Machine Learning" class="tag"><span class="term">Machine Learning</span></a><a href="/tags/#SVM" title="Pages tagged SVM" class="tag"><span class="term">SVM</span></a></span> <span class="social-share"> <a href="https://www.facebook.com/sharer/sharer.php?u=/%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/" title="Share on Facebook" class="tag"> <span class="term"><i class="fa fa-facebook-square"></i> Share</span> </a> <a href="https://twitter.com/intent/tweet?text=/%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/" title="Share on Twitter" class="tag"> <span class="term"><i class="fa fa-twitter-square"></i> Tweet</span> </a> <a href="https://plus.google.com/share?url=/%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/" title="Share on Google+" class="tag"> <span class="term"><i class="fa fa-google-plus-square"></i> +1</span> </a> </span> <div style="clear:both"></div> </div> </div> </div> </header> <!-- JS --> <script src="/assets/js/jquery-1.12.0.min.js"></script> <script src="/assets/js/jquery.dlmenu.min.js"></script> <script src="/assets/js/jquery.goup.min.js"></script> <script src="/assets/js/jquery.magnific-popup.min.js"></script> <script src="/assets/js/jquery.fitvid.min.js"></script> <script src="/assets/js/scripts.js"></script> <!-- MathJax --> <script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> </body> </html>
